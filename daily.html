<!DOCTYPE html>
<html lang="ko">
    <head>
        <title>daily</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="./style/dailyStyle.css" />
        <script>
            window.onload = function () {
                const images = document.querySelectorAll("img.post-img");

                if (window.innerWidth < 400) {
                    images.forEach((img) => {
                        const url = new URL(img.src);

                        url.pathname = url.pathname.replace(
                            /(\/img\/[a-zA-Z]+)(\.png)$/,
                            "$1-1$2"
                        );

                        img.src = url.href;
                    });
                } else {
                    images.forEach((img) => {
                        const url = new URL(img.src);

                        url.pathname = url.pathname.replace(/-1\.png$/, ".png");
                        img.src = url.href;
                    });
                }
            };

            document.addEventListener("DOMContentLoaded", (event) => {
                const initialDailyArray = [
                    {
                        id: 0,
                        moodEng: "happy",
                        mood: "행복해요",
                        date: today,
                        title: "타이틀 영역입니다.",
                        content: "컨텐츠 영역입니다.",
                        img: `./img/happy.png`,
                        comments: [],
                    },
                    {
                        id: 1,
                        moodEng: "sad",
                        mood: "슬퍼요",
                        date: today,
                        title: "타이틀 영역입니다.",
                        content: "컨텐츠 영역입니다.",
                        img: `./img/sad.png`,
                        comments: [],
                    },
                    {
                        id: 2,
                        moodEng: "surprise",
                        mood: "놀랐어요",
                        date: today,
                        title: "타이틀영역입니다.",
                        content: "컨텐츠 영역입니다.",
                        img: `./img/surprise.png`,
                        comments: [],
                    },
                    {
                        id: 3,
                        moodEng: "etc",
                        mood: "기타",
                        date: today,
                        title: "타이틀 영역입니다.",
                        content: "컨텐츠 영역입니다.",
                        img: `./img/etc.png`,
                        comments: [],
                    },
                    {
                        id: 4,
                        moodEng: "angry",
                        mood: "화나요",
                        date: today,
                        title: "타이틀 영역입니다.",
                        content: "컨텐츠 영역입니다.",
                        img: `./img/angry.png`,
                        comments: [],
                    },
                ];
                const dailyArray = JSON.parse(
                    localStorage.getItem("dailyArray")
                );

                const parentElement = document.getElementById("post");

                if (!dailyArray) {
                    localStorage.setItem(
                        "dailyArray",
                        JSON.stringify(initialDailyArray)
                    );
                    initialDailyArray.map((resultObject, index) => {
                        const postContainer = document.createElement("a");
                        postContainer.href = `./dailyDetailInfor.html?id=${resultObject.id}`;
                        postContainer.className = "post-container";
                        postContainer.id = `${resultObject.id}`;
                        postContainer.innerHTML = `
                <img src="${resultObject.img}" alt="1" id=${resultObject.id}  class="post-img" />
                <div class="post-title">
                    <div class="post-font-${resultObject.moodEng}">${resultObject.mood}</div>
                    <div class="post-date">${resultObject.date}</div>
                </div>
                <div class="post-content">${resultObject.title}</div>
                <button class="post-delete" onclick="onClickDelete(event)">X</button>
            `;

                        parentElement.appendChild(postContainer);
                    });
                    localStorage.setItem("idx", 5);
                } else {
                    dailyArray.map((resultObject, index) => {
                        const postContainer = document.createElement("a");
                        postContainer.href = `./dailyDetailInfor.html?id=${resultObject.id}`;
                        postContainer.className = "post-container";
                        postContainer.id = `${resultObject.id}`;
                        postContainer.innerHTML = `
                <img src="${resultObject.img}" alt="1" id=${resultObject.id}  class="post-img" />
                <div class="post-title">
                    <div class="post-font-${resultObject.moodEng}">${resultObject.mood}</div>
                    <div class="post-date">${resultObject.date}</div>
                </div>
                <div class="post-content">${resultObject.title}</div>
                <button class="post-delete" onclick="onClickDelete(event)">X</button>
            `;

                        parentElement.appendChild(postContainer);
                    });
                    localStorage.setItem("idx", dailyArray.length);
                }
            });

            addEventListener("resize", () => {
                const images = document.querySelectorAll("img.post-img");

                if (window.innerWidth < 400) {
                    images.forEach((img) => {
                        const url = new URL(img.src);

                        url.pathname = url.pathname.replace(
                            /(\/img\/[a-zA-Z]+)(\.png)$/,
                            "$1-1$2"
                        );

                        img.src = url.href;
                    });
                } else {
                    images.forEach((img) => {
                        const url = new URL(img.src);

                        url.pathname = url.pathname.replace(/-1\.png$/, ".png");
                        img.src = url.href;
                    });
                }
            });
        </script>
    </head>
    <body>
        <main>
            <header>
                <div class="header-text-container">
                    <div class="header-text">민지의 다이어리</div>
                </div>
                <img src="./img/Rectangle1.png" alt="img" class="header-img" />
            </header>
            <article>
                <div class="article-header">
                    <div class="article-header-container">
                        <div
                            class="article-header-font"
                            onclick="onClickChangePost(event)"
                            id="article-daily"
                        >
                            일기 보관함
                        </div>
                        <div
                            class="article-header-text"
                            id="article-picture"
                            onclick="onClickChangePost(event)"
                        >
                            사진 보관함
                        </div>
                        <select
                            name=""
                            id="select-post"
                            class="select-post"
                            onchange="onChangeSelected(event)"
                        >
                            <option disabled selected>전체</option>
                            <option value="happy">행복해요</option>
                            <option value="sad">슬퍼요</option>
                            <option value="surprise">놀랐어요</option>
                            <option value="angry">화나요</option>
                            <option value="etc">기타</option>
                        </select>
                        <select
                            name=""
                            id="select-post1"
                            class="select-post1"
                            onchange="onChangeRatio(event)"
                        >
                            <option value="default">기본</option>
                            <option value="row">가로형</option>
                            <option value="col">세로형</option>
                        </select>
                    </div>
                    <div class="article-daily" onclick="onClickModal()">
                        <div class="">+</div>
                        <div class="">일기 쓰기</div>
                    </div>
                </div>
                <div id="article-main" class="article-main">
                    <div id="post" class="post"></div>
                    <div class="floating-button" onclick="onClickUp()">
                        <svg
                            width="19"
                            height="10"
                            viewBox="0 0 19 10"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M9.10145 2.61068L2.0598 9.65232C1.82029 9.89183 1.53687 10.0076 1.20953 9.99961C0.882202 9.99163 0.598779 9.86788 0.359268 9.62837C0.119756 9.38886 0 9.10544 0 8.7781C0 8.45077 0.119756 8.16735 0.359268 7.92784L7.73623 0.574828C7.92784 0.383219 8.1434 0.239511 8.38291 0.143707C8.62242 0.0479021 8.86193 0 9.10145 0C9.34096 0 9.58047 0.0479021 9.81998 0.143707C10.0595 0.239511 10.2751 0.383219 10.4667 0.574828L17.8436 7.95179C18.0831 8.1913 18.1989 8.47073 18.1909 8.79008C18.1829 9.10943 18.0592 9.38886 17.8197 9.62837C17.5802 9.86788 17.2967 9.98764 16.9694 9.98764C16.6421 9.98764 16.3587 9.86788 16.1191 9.62837L9.10145 2.61068Z"
                                fill="#5F6368"
                            />
                        </svg>
                    </div>
                </div>
                <div
                    id="article-picture-component"
                    class="article-picture-component"
                >
                    <div>
                        <div class="dog-img-before">
                            <div class="line"></div>
                        </div>
                    </div>
                </div>
            </article>
        </main>
        <footer>
            <div class="footer_container">
                <div class="footer-1">민지의 다이어리</div>
                <div class="footer-2">대표 : 민지</div>
                <div class="footer-3">Copyright © 2024. {name} Co., Ltd.</div>
            </div>
        </footer>
        <div id="modal" class="modal" onclick="onClickModalBlank(event)">
            <div class="modal_container">
                <div class="daily-header">읽기 쓰기</div>
                <div class="daily-checkcontainer">
                    <div>오늘 기분은 어땟나요?</div>
                    <div class="daily-inputlist">
                        <div class="daily-input">
                            <input
                                type="radio"
                                oninput="onInputButtonChange()"
                                name="radio"
                                class="input-radio"
                                id="happy"
                            />
                            <label for="">행복해요</label>
                        </div>
                        <div class="daily-input">
                            <input
                                type="radio"
                                oninput="onInputButtonChange()"
                                name="radio"
                                class="input-radio"
                                id="sad"
                            />
                            <label for="">슬퍼요</label>
                        </div>
                        <div class="daily-input">
                            <input
                                type="radio"
                                oninput="onInputButtonChange()"
                                name="radio"
                                class="input-radio"
                                id="surprise"
                            />
                            <label for="">놀랐어요</label>
                        </div>
                        <div class="daily-input">
                            <input
                                type="radio"
                                oninput="onInputButtonChange()"
                                name="radio"
                                class="input-radio"
                                id="angry"
                            />
                            <label for="">화나요</label>
                        </div>
                        <div class="daily-input">
                            <input
                                type="radio"
                                oninput="onInputButtonChange()"
                                name="radio"
                                class="input-radio"
                                id="etc"
                            />
                            <label for="">기타</label>
                        </div>
                    </div>
                </div>
                <div class="daily-form">
                    <div class="daily-form-input">
                        <div class="daily-title">
                            <div>제목</div>
                            <input
                                type="text"
                                id="titleId"
                                class="input-title"
                                placeholder="제목을 입력해 주세요."
                                oninput="onInputButtonChange()"
                            />
                        </div>
                        <div class="daily-title">
                            <div>내용</div>
                            <textarea
                                id="contentId"
                                class="input-title input-content"
                                placeholder="내용을 입력해주세요"
                                oninput="onInputButtonChange()"
                            ></textarea>
                        </div>
                    </div>
                    <div class="modal-button-container">
                        <button
                            class="submit-delete-button"
                            onclick="onClickModalFail()"
                        >
                            삭제
                        </button>
                        <button
                            id="submitButton"
                            class="submit-button"
                            onclick="onClickModalSuccess()"
                            disabled
                        >
                            등록하기
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div id="modal_success_container" class="modal_success_container">
            <div class="modal_success">
                <div class="daily-header">일기 등록 완료</div>
                <div>등록이 완료되었습니다.</div>
                <button class="modal_success_button" onclick="pushDaily()">
                    확인
                </button>
            </div>
        </div>
        <div id="modal_fail_container" class="modal_fail_container">
            <div class="modal_success">
                <div class="daily-header">일기 등록 취소</div>
                <div>일기 등록을 취소하시겠어요?</div>
                <div class="modal_fail_button_container">
                    <button
                        class="modal_fail_button1"
                        onclick="onClickContinueWriting()"
                    >
                        계속 작성
                    </button>
                    <button
                        class="modal_fail_button2"
                        onclick="onClickCancelRegister()"
                    >
                        등록 취소
                    </button>
                </div>
            </div>
        </div>
        <!-- <div class="modal_fail"></div> -->
    </body>

    <script src="./utils/pushDaily.js"></script>
    <script src="./utils/onClickDailyInfor.js"></script>
    <script src="./utils/onInputButtonChange.js"></script>
    <script src="./utils/onChangeSelected.js"></script>
    <script src="./utils/onClickDelete.js"></script>
    <script src="./utils/onClickUp.js"></script>
    <script src="./utils/isScroll.js"></script>
    <script src="./utils/onClickModal.js"></script>
    <script src="./utils/onClickModalSuccess.js"></script>
    <script src="./utils/onClickModalFail.js"></script>
    <script src="./utils/onClickContinueWriting.js"></script>
    <script src="./utils/onClickCancelRegister.js"></script>
    <script src="./utils/onClickModalBlank.js"></script>
    <script src="./utils/onKeydownEsc.js"></script>
    <script src="./utils/onClickChangePost.js"></script>
    <script src="./utils/onChangeRatio.js"></script>
</html>
